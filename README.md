# 年末調整書類記入サポートツール（令和7年版）

## 📋 概要

年末調整の手書き対応における記入難易度の高い書類について、従業員の記入をサポートする入力補助ツールです。

**対象書類**:
- 令和7年分 基礎控除申告書
- 令和7年分 配偶者控除等申告書
- 令和7年分 特定親族特別控除申告書（新設）
- 令和7年分 所得金額調整控除申告書

## ✨ 主な機能

### 1. 基礎控除申告書サポート
- 給与収入から給与所得を自動計算（給与所得控除の適用）
- 合計所得金額に応じた基礎控除額の判定（令和7年版：9段階の控除額）
- 区分（A/B/C）の自動判定
- 申告書への記入方法を分かりやすく表示

### 2. 配偶者控除等申告書サポート
- 配偶者の所得から適用される控除種別を自動判定
- 配偶者控除（一般38万円/老人48万円）または配偶者特別控除の計算
- 配偶者の所得要件（58万円以下）の自動判定
- 本人の所得による控除額の段階的減額に対応

### 3. 特定親族特別控除申告書サポート（令和7年新設）
- 19歳以上23歳未満の扶養親族の年齢判定
- 所得要件（58万円超123万円以下）の自動チェック
- 控除額の自動計算（最大63万円）

### 4. 所得金額調整控除申告書サポート
- 年収850万円超の判定
- 特別障害者・23歳未満扶養親族の要件確認
- 控除額の自動計算（最大15万円）

### 5. データ管理機能
- **自動保存**: 入力データをLocalStorageに自動保存（プライバシー保護）
- **CSV出力**: 計算結果をCSVファイルとしてエクスポート
- **印刷機能**: 計算結果を印刷して手書き書類の記入に活用
- **データクリア**: すべての入力データを一括クリア

## 🚀 使い方

### 基本的な使用手順

1. **index.html をブラウザで開く**
   - ファイルをダブルクリック、または右クリック→「プログラムから開く」→ブラウザを選択
   - インターネット接続は不要（ローカル完結）

2. **基本情報を入力**
   - 氏名を入力
   - 年間給与収入額（見込み）を入力
   - 給与以外の所得がある場合は入力

3. **該当する控除項目を入力**
   - タブを切り替えて各申告書の入力を行う
   - 配偶者がいる場合：「配偶者控除等申告書」タブで入力
   - 19-23歳の扶養親族がいる場合：「特定親族特別控除申告書」タブで入力
   - 年収850万円超の場合：「所得金額調整控除申告書」タブで確認

4. **計算結果を確認**
   - 入力すると自動的に計算結果が表示されます
   - 控除額と申告書への記入方法を確認

5. **結果を活用**
   - 印刷ボタンで印刷プレビューを表示
   - CSV出力で計算結果をファイル保存
   - 手書き書類の記入に活用

## 📱 動作環境

- **ブラウザ**: Chrome, Edge, Firefox, Safari（最新版推奨）
- **デバイス**: PC、タブレット
- **インターネット接続**: 不要（ローカル完結）
- **IE11**: 非対応

## 🔒 セキュリティ・プライバシー

- **外部通信なし**: すべての処理がローカルPC上で完結
- **データ保存**: LocalStorageに保存（ブラウザ内のみ）
- **個人情報保護**: 外部サーバーへの送信は一切なし
- **データ削除**: ブラウザのキャッシュクリアで完全削除可能

## 💡 使用例

### ケース1: 年収400万円、配偶者なし
1. 基礎控除申告書タブで年収「4,000,000」を入力
2. 計算結果: 給与所得276万円、基礎控除88万円、区分A
3. 申告書に「A」と記入

### ケース2: 年収600万円、配偶者の年収103万円
1. 基礎控除申告書タブで本人の年収を入力
2. 配偶者控除等申告書タブで「配偶者がいる」をチェック
3. 配偶者の年収「1,030,000」を入力
4. 計算結果: 配偶者控除38万円が適用（配偶者所得38万円は58万円以下のため）

### ケース3: 年収1,000万円、20歳の子供（アルバイト年収150万円）
1. 基礎控除申告書タブで本人の年収を入力
2. 特定親族特別控除申告書タブで「19歳以上23歳未満の扶養親族がいる」をチェック
3. 子供の生年月日と年収を入力
4. 計算結果: 特定親族特別控除63万円が適用（子供の所得85万円は58万円超〜85万円以下のため）

## 📊 計算ロジック（令和7年版）

### 給与所得控除
**根拠**: 国税庁「令和7年度税制改正Q&A」1-3

| 給与収入 | 給与所得控除額 |
|---------|-------------|
| 162.5万円以下 | **65万円**（改正：55万円→65万円） |
| 162.5万円超180万円以下 | 収入×40%-10万円 |
| 180万円超360万円以下 | 収入×30%+8万円 |
| 360万円超660万円以下 | 収入×20%+44万円 |
| 660万円超850万円以下 | 収入×10%+110万円 |
| 850万円超 | 195万円（上限） |

**給与所得の計算式**: 給与所得 = 給与収入 - 給与所得控除額

### 基礎控除額（9段階テーブル）
**根拠**: 国税庁「令和7年分の年末調整のための算出所得税額の速算表」

| 合計所得金額 | 基礎控除額 | 備考 |
|-----------|----------|------|
| 132万円以下 | **95万円** | 新設 |
| 132万円超336万円以下 | **88万円** | 新設 |
| 336万円超489万円以下 | **68万円** | 新設 |
| 489万円超655万円以下 | **63万円** | 新設 |
| 655万円超2,350万円以下 | **58万円** | 新設 |
| 2,350万円超2,400万円以下 | 48万円 | - |
| 2,400万円超2,450万円以下 | 32万円 | - |
| 2,450万円超2,500万円以下 | 16万円 | - |
| 2,500万円超 | 0円 | - |

**区分の判定**（配偶者控除等で使用）:
- **区分A**: 合計所得金額900万円以下
- **区分B**: 合計所得金額900万円超950万円以下
- **区分C**: 合計所得金額950万円超

### 配偶者控除・配偶者特別控除
**根拠**: 国税庁タックスアンサー No.1191, No.1195

#### 配偶者控除の所得要件
- 配偶者の合計所得金額が**58万円以下**（改正：48万円→58万円）
- 給与のみの場合、年収123万円以下

#### 配偶者控除額
| 本人所得 | 一般 | 老人（70歳以上） |
|---------|-----|---------------|
| 900万円以下 | **38万円** | **48万円** |
| 900万円超950万円以下 | **26万円** | **32万円** |
| 950万円超1,000万円以下 | **13万円** | **16万円** |
| 1,000万円超 | 適用なし | 適用なし |

#### 配偶者特別控除（配偶者所得58万円超〜133万円以下）
最大控除額：**38万円**（本人所得900万円以下の場合）
- 配偶者所得に応じて9段階で逓減
- 本人所得900万円超では段階的に減額

### 特定親族特別控除（令和7年新設）
**根拠**: 国税庁タックスアンサー No.1177

#### 要件
- 年齢：19歳以上23歳未満（12月31日時点）
- 所得：58万円超123万円以下

#### 控除額（特定親族の所得金額別）
| 特定親族の所得 | 控除額 |
|-------------|-------|
| 58万円超85万円以下 | **63万円** |
| 85万円超90万円以下 | **61万円** |
| 90万円超95万円以下 | **51万円** |
| 95万円超100万円以下 | **41万円** |
| 100万円超105万円以下 | **31万円** |
| 105万円超110万円以下 | **21万円** |
| 110万円超115万円以下 | **11万円** |
| 115万円超120万円以下 | **6万円** |
| 120万円超123万円以下 | **3万円** |

**注意**: 本人の所得が1,000万円超の場合は適用なし

### 所得金額調整控除
**根拠**: 国税庁タックスアンサー No.1411

#### 要件
- 給与収入850万円超
- 以下のいずれかに該当：
  - 本人が特別障害者
  - 23歳未満の扶養親族がいる
  - 特別障害者である同一生計配偶者または扶養親族がいる

#### 計算式
```
控除額 = {給与収入（1,000万円上限） - 850万円} × 10%
```
- 1円未満は**切り上げ**（Math.ceil）
- 上限：15万円

## 🛠️ ファイル構成

```
nenmatsuchosei/
├── index.html          # メインページ
├── style.css           # スタイルシート
├── app.js             # メインアプリケーションロジック
├── calculator.js      # 計算エンジン
├── validator.js       # バリデーション
└── README.md          # 使用説明書（このファイル）
```

## ⚠️ 注意事項

### 📌 使用上の重要な注意

1. **合計所得金額の定義**
   - このツールで計算される「合計所得金額」は **給与所得（給与収入 - 給与所得控除）+ その他の所得** です
   - 給与収入をそのまま入力しないでください。自動的に給与所得控除が適用されます
   - 給与以外の所得（事業所得・不動産所得など）がある場合は、「その他の所得」欄に入力してください

2. **区分A/B/Cの判定**
   - 配偶者控除等申告書で使用される区分は、**本人の合計所得金額**で決まります：
     - 区分A：900万円以下
     - 区分B：900万円超950万円以下
     - 区分C：950万円超
   - 基礎控除申告書の区分と混同しないよう注意してください

3. **境界値での計算**
   - 所得が132万円、336万円、489万円などの境界値ちょうどの場合、控除額が変わります
   - 計算結果を必ず確認してください
   - 配偶者の所得が58万円と58万1円では控除の種類が変わります（配偶者控除 vs 配偶者特別控除）

4. **本人所得1,000万円超の制限**
   - 本人の所得が1,000万円を超える場合：
     - 配偶者控除等：適用なし
     - 特定親族特別控除：適用なし
   - 基礎控除は適用されますが、金額が段階的に減額されます

### 一般的な注意事項

1. **最終確認は必須**: このツールは計算補助を目的としています。最終的な申告内容は勤務先の指示に従ってください。

2. **税制改正への対応**: 令和7年の税制に基づいています。翌年以降は税制改正により計算式が変わる可能性があります。

3. **複雑なケース**: 以下のような複雑なケースは、税理士や勤務先の担当者にご相談ください：
   - 複数の給与所得がある場合
   - 事業所得・不動産所得など複雑な所得がある場合
   - 災害減免や住宅ローン控除などの特例がある場合

4. **データのバックアップ**: ブラウザのキャッシュクリアでデータが消える可能性があります。重要なデータはCSV出力で保存してください。

## 🔧 トラブルシューティング

### 計算結果が表示されない
- ブラウザのJavaScriptが有効になっているか確認
- ブラウザのキャッシュをクリアして再読み込み
- 別のブラウザで試す

### データが保存されない
- LocalStorageが無効になっていないか確認
- プライベートモード（シークレットモード）では保存されません
- ブラウザの設定でCookieとサイトデータが許可されているか確認

### 印刷がうまくいかない
- ブラウザの印刷プレビューで確認
- 用紙サイズをA4に設定
- 余白を適切に調整

## 📝 更新履歴

### v1.1.0 (2025-11-18) - 令和7年版税制改正対応
**全7項目の税制改正を反映**

1. **基礎控除テーブルの更新**
   - 旧仕様：48万/32万/16万/0円の4段階
   - 新仕様：95万/88万/68万/63万/58万/48万/32万/16万/0円の9段階
   - 根拠：国税庁「令和7年分の年末調整のための算出所得税額の速算表」

2. **給与所得控除の最低保障額変更**
   - 旧：55万円 → 新：65万円
   - 根拠：国税庁「令和7年度税制改正Q&A」1-3

3. **配偶者控除の所得要件変更**
   - 旧：48万円以下 → 新：58万円以下
   - 根拠：国税庁タックスアンサー No.1191

4. **配偶者控除額の修正**
   - 一般：48万円 → 38万円
   - 老人：58万円 → 48万円
   - 根拠：国税庁タックスアンサー No.1191

5. **配偶者特別控除テーブルの更新**
   - 令和7年版テーブル（58万円超〜133万円以下の9段階）に変更
   - 最大額：48万円 → 38万円
   - 根拠：国税庁タックスアンサー No.1195

6. **特定親族特別控除の更新**
   - 最大額：25万円 → 63万円
   - 58万円超〜123万円以下の9段階テーブルを実装
   - 根拠：国税庁タックスアンサー No.1177

7. **所得金額調整控除の端数処理修正**
   - 端数処理：切り捨て（Math.floor） → 切り上げ（Math.ceil）
   - 根拠：国税庁タックスアンサー No.1411

**テスト結果**: 全37ケース合格（成功率100%）

### v1.0.0 (2025-11-17)
- 初回リリース
- 基礎控除申告書サポート機能実装
- 配偶者控除等申告書サポート機能実装
- 特定親族特別控除申告書サポート機能実装（令和7年新設対応）
- 所得金額調整控除申告書サポート機能実装
- 保険料控除申告書サポート機能実装（Phase 3）
- LocalStorage対応
- CSV出力機能
- 印刷機能

## 📄 ライセンス

このツールは個人・法人問わず自由に使用できます。

## 🤝 サポート

不具合や改善要望がある場合は、開発者にお問い合わせください。

---

**免責事項**: このツールは計算補助を目的としており、計算結果の正確性を保証するものではありません。年末調整の申告は自己責任で行ってください。
